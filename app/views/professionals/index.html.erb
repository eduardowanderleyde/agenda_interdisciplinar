<p style="color: green"><%= notice %></p>

<style>
  .tabela-profissionais {
    width: 100%;
    table-layout: auto;
    word-break: break-word;
  }
  .tabela-profissionais th, .tabela-profissionais td {
    white-space: normal !important;
    word-break: break-word;
    padding: 16px 12px;
    font-size: 1.05em;
  }
  @media (max-width: 900px) {
    .tabela-profissionais th, .tabela-profissionais td {
      font-size: 0.95em;
      padding: 8px 4px;
    }
  }
</style>

<div class="max-w-full px-8 py-10">
  <div class="flex justify-between items-center mb-8">
    <h1 class="text-4xl font-bold text-gray-900 text-center">Profissionais</h1>
    <%= link_to "Novo Profissional", new_professional_path, class: "btn btn-primary bg-indigo-600 text-white px-4 py-2 rounded shadow hover:bg-indigo-700 transition" %>
  </div>
  <div class="bg-white rounded-xl shadow">
    <table class="tabela-profissionais min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th class="text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
          <th class="text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Dias Disponíveis</th>
          <th class="text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Horários Disponíveis</th>
          <th class="text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        <% dias_semana = {
          'monday' => 'Segunda-feira', 'mon' => 'Segunda-feira', 'segunda' => 'Segunda-feira', 's' => 'Segunda-feira',
          'tuesday' => 'Terça-feira', 'tue' => 'Terça-feira', 'terça' => 'Terça-feira', 'n' => 'Terça-feira',
          'wednesday' => 'Quarta-feira', 'wed' => 'Quarta-feira', 'quarta' => 'Quarta-feira', 'q' => 'Quarta-feira',
          'thursday' => 'Quinta-feira', 'thu' => 'Quinta-feira', 'quinta' => 'Quinta-feira', 'a' => 'Quinta-feira',
          'friday' => 'Sexta-feira', 'fri' => 'Sexta-feira', 'sexta' => 'Sexta-feira', 'x' => 'Sexta-feira',
          'saturday' => 'Sábado', 'sat' => 'Sábado', 'sábado' => 'Sábado', 'b' => 'Sábado',
          'sunday' => 'Domingo', 'sun' => 'Domingo', 'domingo' => 'Domingo', 'd' => 'Domingo'
        } %>
        <% @professionals.each do |professional| %>
          <tr>
            <td class="font-semibold text-gray-800"><%= professional.name %></td>
            <td class="text-gray-700">
              <% dias = (professional.available_days || []).map { |d| dias_semana[d.to_s.strip.downcase] || d }.uniq.join(', ') %>
              <%= dias.presence || '-' %>
            </td>
            <td class="text-gray-700">
              <% dias_semana_lista = [
                ['monday', 'Segunda'],
                ['tuesday', 'Terça'],
                ['wednesday', 'Quarta'],
                ['thursday', 'Quinta'],
                ['friday', 'Sexta']
              ] %>
              <% ah = professional.available_hours.is_a?(Hash) ? professional.available_hours : {} %>
              <% horarios = dias_semana_lista.map do |dia_key, dia_label|
                hs = (ah[dia_key] || [])
                hs.any? ? "#{dia_label}: #{hs.join(', ')}" : nil
              end.compact.join(' | ') %>
              <%= horarios.presence || '-' %>
            </td>
            <td class="text-center bg-gray-50">
              <div class="flex justify-center gap-2">
                <%= link_to 'Editar', edit_professional_path(professional), class: 'btn btn-sm btn-secondary bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 transition font-bold shadow' %>
                <%= button_to 'Excluir', professional_path(professional), method: :delete, data: { confirm: 'Tem certeza?' }, class: 'btn btn-sm btn-danger bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 transition font-bold shadow' %>
              </div>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <div class="mt-4">
      <%= pagy_nav(@pagy) %>
    </div>
  </div>
</div>
